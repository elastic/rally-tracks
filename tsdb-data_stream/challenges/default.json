    {
      "name": "append-no-conflicts",
      "description": "Indexes the whole document corpus.",
      "default": true,
      "schedule": [
        {
          "name": "put-timestamp-pipeline",
          "operation": {
            "operation-type": "put-pipeline",
            "id": "timestamp_pipeline",
            "body": {
              "description": "Sets @timestamp field to current time",
              "processors": [
                {
                  "script": {
                    "source": "ZonedDateTime fixed = ZonedDateTime.parse('2021-04-28T17:18:23.410Z');long delta = System.currentTimeMillis() - fixed.toInstant().toEpochMilli();ctx['@timestamp'] = ZonedDateTime.parse(ctx['@timestamp']).plus(delta, ChronoUnit.MILLIS).toString();"
                  }
                }
              ]
            }
          }
        },
        {
          "name": "create-ilm-policy",
          "operation": {
            "operation-type": "create-ilm-policy",
            "policy-name": "7-days-tsdb",
            "body": {
              "policy": {
                "phases": {
                  "hot": {
                    "actions": {
                      "rollover": {
                        "max_primary_shard_size": "1gb",
                        "max_age": "1d"
                      }
                    }
                  },
                  "warm": {
                    "min_age": "1h",
                    "actions": {
                      "shrink": {
                        "number_of_shards": 1
                      },
                      "forcemerge": {
                        "max_num_segments": 1
                      }
                    }
                  },
                  "delete": {
                    "min_age": "7d",
                    "actions":{
                      "delete": {}
                    }
                  }
                }
              }              
            }
          }
        },
        {
          "name": "create-all-templates",
          "operation": {
            "operation-type": "create-composable-template",
            "request-params": {
              "create": "true"
            }
          }
        },
        {
          "name": "check-cluster-health",
          "operation": {
            "operation-type": "cluster-health",
            "request-params": {
              "wait_for_status": "{{cluster_health | default('green')}}",
              "wait_for_no_relocating_shards": "true"
            },
            "retry-until-success": true
          }
        },
        {
          "operation": "index",
          "warmup-time-period": 240,
          "clients": {{bulk_indexing_clients | default(8)}},
          "ignore-response-error-level": "{{error_level | default('non-fatal')}}"
        },
        {
          "name": "refresh-after-index",
          "operation": "refresh"
        }
      ]
    }