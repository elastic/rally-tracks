{
  "settings": {
    {% if enable_logsdb %}
      "index.mode": "logsdb",
      {% if patterned_text_message_field | default(false) is true %}
      "index.sort.field": ["message.template_id", "@timestamp"],
      "index.sort.order":["asc", "desc"],
      {% else %}
      "index.sort.field": ["@timestamp"],
      "index.sort.order":["desc"],
      {% endif %}
    {% endif %}

    "index.number_of_shards": {{ number_of_shards | default(5) }},
    "index.number_of_replicas": {{ number_of_replicas | default(0) }},
    "index.requests.cache.enable": false
  },
  "mappings": {
    "dynamic": "strict",
    {% if enable_logsdb %}
    {% else %}
    "_source": {
    "enabled": {{ source_enabled | default(true) | tojson }}
    },
    {% endif %}
    "properties": {
      "@timestamp": {
        "format": "strict_date_optional_time",
        "type": "date"
      },
      "message": {
        {% if patterned_text_message_field | default(false) is true %}
        "type": "patterned_text",
        "index_options": {{ patterned_text_index_options | default("docs") | tojson }}
        {% else %}
        "type": "match_only_text"
        {% endif %}
      }
    }
  }
}
