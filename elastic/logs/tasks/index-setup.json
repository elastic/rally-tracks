{%- if p_use_static_assets == true %}
{% include "tasks/static-asset-setup.json" %}
{% else %}
{% include "tasks/package-asset-setup.json" %}
{%- endif %}
{
  "name": "create-required-data-streams",
  "tags": ["setup"],
  "operation": {
    "operation-type": "create-data-stream"
  }
},
{
  "name": "check-cluster-health",
  "operation": {
    "operation-type": "cluster-health",
    "index": "_all",
    "request-params": {
      "wait_for_status": "{{wait_for_status | default('green')}}",
      "wait_for_no_relocating_shards": "true"
    },
    "retry-until-success": true
  }
},
{
  "name": "wait-until-merges-finish",
  "tags": ["setup"],
  "operation": {
    "operation-type": "index-stats",
    "index": "_all",
    "condition": {
      "path": "_all.total.merges.current",
      "expected-value": 0
    },
    "retry-until-success": true,
    "include-in-reporting": false
  }
}
