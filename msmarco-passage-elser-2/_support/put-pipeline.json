{
  "name": "setup-elser-pipeline",
  "operation-type": "put-pipeline",
  "id": "elser2",
  "body": {
    "description": "Pipes documents to ELSER",
    "processors": [
      {
        "inference": {
          "model_id": ".elser_model_1",
          "target_field": "ml",
          "field_map": {
            "text": "text_field"
          },
          "inference_config": {
            "text_expansion": {
              "results_field": "tokens"
            }
          }
        }
      }
    ],
    "on_failure": [
      {
        "set": {
          "field": "_index",
          {% raw %}
          "value": "failed-{{ _index }}"
          {% endraw %}
        }
      }
    ]
  }
}